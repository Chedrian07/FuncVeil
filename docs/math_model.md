# FuncVeil: 미적분 기반 비가역 개인정보 마스킹 시스템 수학 모델

이 문서는 FuncVeil 프로젝트에서 사용되는 수학적 모델과 개념을 상세히 설명합니다. 고등학교 교육과정에서 배우는 미적분 개념을 활용하여 개인정보를 마스킹하는 방법을 설명합니다.

## 1. 기본 연속 함수 기반 마스킹

가장 기본적인 마스킹 함수는 사인 함수를 기반으로 합니다. 입력값 x를 정규화한 후 사인 함수에 적용하고, 적절한 파라미터를 통해 변환합니다.

### 1.1 기본 수식

$$f(x) = A \cdot \sin(\omega \cdot \frac{x - L}{U - L} + \phi) + B$$

여기서:
- $x \in [L, U]$: 마스킹할 입력값의 범위
- $A$: 진폭 (amplitude)
- $\omega$: 각속도 (angular velocity)
- $\phi$: 위상 (phase)
- $B$: y축 이동 (y-offset)

### 1.2 정규화 과정

입력값 x를 [0, 1] 범위로 정규화:

$$\hat{x} = \frac{x - L}{U - L}$$

그 후 사인 함수를 적용합니다:

$$f(\hat{x}) = A \cdot \sin(\omega \cdot \hat{x} + \phi) + B$$

### 1.3 파라미터 생성

파라미터 $A$, $\omega$, $\phi$, $B$는 시드값을 기반으로 확정적으로(deterministically) 생성됩니다. 이를 통해 동일한 입력에 대해 항상 동일한 마스킹 결과를 얻을 수 있습니다.
## 2. 역변환 방지 메커니즘

### 2.1 비단조성(Non-monotonicity)

사인 함수의 비단조적 특성으로 인해, 기본적으로 마스킹 함수는 가역적이지 않습니다. 여러 입력값이 동일한 출력값에 매핑될 수 있기 때문입니다.

이를 측정하기 위해 '역변환 가능성 점수(Invertibility Score)'를 계산할 수 있습니다:

$$\text{InvertibilityScore} = \frac{\text{입력값 개수}}{\text{고유 출력값 개수}}$$

점수가 1에 가까울수록 일대일 매핑(역변환 가능)에 가깝고, 값이 클수록 다대일 매핑(역변환 어려움)이 많음을 의미합니다.

### 2.2 HMAC 해시 결합

추가적인 보안을 위해 HMAC 해시 함수를 결합할 수 있습니다:

$$f(x) = \text{HMAC}_{\text{key}}(x) \parallel \text{round}(A \cdot \sin(\omega \cdot \hat{x} + \phi) + B, n)$$

여기서:
- $\text{HMAC}_{\text{key}}(x)$: 비밀 키를 사용한 HMAC 해시
- $\parallel$: 문자열 결합 연산자

HMAC 해시를 접두사로 추가하면 역산 시 해시와 마스킹 함수를 동시에 만족해야 하므로 비가역성이 강화됩니다.

## 3. 단조 구간 제한 (교육 목적)

교육적 목적으로 마스킹 함수의 단조성을 보장하여 역함수가 존재하게 만들 수 있습니다.

### 3.1 단조 증가 조건

사인 함수가 $[-\pi/2, \pi/2]$ 구간에서 단조 증가함을 이용하여 다음 조건을 적용:

$$\omega \cdot (U - L) \leq \pi$$

이 조건을 적용하면 정규화된 입력 범위인 [0, 1]에 대해 함수가 단조 증가하게 됩니다.
## 4. 차분 프라이버시(Differential Privacy) 적용

개인정보 보호를 강화하기 위해 차분 프라이버시 개념을 적용할 수 있습니다.

### 4.1 기본 개념

차분 프라이버시는 데이터셋에 특정 레코드의 추가/제거가 결과에 미치는 영향을 제한하는 기법입니다. 마스킹 함수에 적절한 노이즈를 추가하여 구현됩니다.

$$f_{DP}(x) = f(x) + \text{Noise}$$

### 4.2 라플라스 노이즈

일반적으로 라플라스 분포에서 노이즈를 추가합니다:

$$f_{DP}(x) = \text{round}(f(x) + L(b), n), \quad b = \frac{\Delta f}{\epsilon}$$

여기서:
- $L(b)$: 스케일 파라미터 $b$를 가진 라플라스 노이즈
- $\Delta f = \max |f'(x)|$: 마스킹 함수의 민감도 (도함수의 최대 절대값)
- $\epsilon$: 프라이버시 파라미터 (작을수록 강한 보호, 큰 노이즈)
- $n$: 반올림 자릿수

### 4.3 민감도 계산

민감도는 도함수의 최대 절대값으로 계산됩니다.

#### 사인 함수의 도함수:

$$f'(x) = A \cdot \omega \cdot \cos(\omega \cdot \hat{x} + \phi) \cdot \frac{1}{U-L}$$

최대 절대값:

$$\Delta f = \max |f'(x)| = \frac{A \cdot \omega}{U-L}$$

#### 복합 함수의 도함수:

$$f'(x) = A_1 \cdot \omega_1 \cdot \cos(\omega_1 \cdot \hat{x} + \phi_1) - A_2 \cdot \omega_2 \cdot \sin(\omega_2 \cdot \hat{x} + \phi_2)$$

#### 지수 함수의 도함수:

$$f'(x) = C \cdot k \cdot e^{k \cdot (x-\text{shift})}$$
## 5. 다중 함수 조합 마스킹

더 복잡한 패턴을 생성하기 위해 여러 함수를 조합할 수 있습니다.

### 5.1 사인-코사인 함수 조합

$$f(x) = A_1 \cdot \sin(\omega_1 \cdot \hat{x} + \phi_1) + B_1 + A_2 \cdot \cos(\omega_2 \cdot \hat{x} + \phi_2) + B_2 + C$$

이 조합은 단일 함수보다 더 복잡한 패턴을 생성하여 역변환 난이도를 높입니다.

### 5.2 미분방정식 기반 함수

미분방정식을 만족하는 함수를 마스킹에 활용할 수 있습니다.

#### 예: 1계 미분방정식

$$\frac{df}{dx} = k \cdot f(x)$$

이 미분방정식의 해는 지수 함수입니다:

$$f(x) = C \cdot e^{kx}$$

#### 로그 함수 변형

로그 함수를 사용한 마스킹 함수:

$$f(x) = a \cdot \log(b \cdot \hat{x} + c) + d$$

## 6. 교육과정 연계성

FuncVeil 프로젝트는 다음과 같은 고등학교 수학 개념을 활용합니다:

1. **함수**: 정의역과 치역, 합성함수, 역함수 등
2. **삼각함수**: 사인, 코사인 함수의 특성과 그래프
3. **지수 및 로그함수**: 성질과 그래프
4. **미분**: 도함수 계산, 극대/극소값 찾기
5. **미분방정식**: 간단한 1계 미분방정식 해법

### 6.1 제안 학습 활동

1. 마스킹 함수 설계하기
2. 함수의 도함수 계산하고 민감도 분석하기
3. 단조 구간 찾고 역함수 존재 조건 탐구하기
4. 차분 프라이버시 노이즈 추가 및 효과 관찰하기
5. 실제 데이터로 마스킹 결과 비교 분석하기

이러한 활동은 수학적 개념을 실생활 문제에 적용하는 능력을 기르는 데 도움이 됩니다.
